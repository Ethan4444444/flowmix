---
title: General demo
author: Sangwon Hyun, Jacob Bien
output: html_document
---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=14, fig.height=5, echo=TRUE, warning=FALSE,
                      message=FALSE, eval=TRUE, cache=TRUE)
library(tidyverse)
outputdir = "~/Desktop"
load_all("~/repos/flowcy/flowcy")  
```

Running and visualizing without regularization
```{r, eval=TRUE, echo=TRUE}
numclust = 10
res = flowmix(ylist=ylist, X=X, numclust=numclust,
              niter = 300)

## These three things are nice to have:
print(res)
plot(res)
plot2d(res, ylist)
```

Internally, `flowmix()` is doing multiple restarts of `flowmix_once()` and
choosing the model that had the best penalized likelihood value.

If you'd like to do cross validation over the regularization parameters (two of
them; one for the regression model for the cluster means, and one for the
cluster membership weights), here is how:

```{r, eval=FALSE}
maxres = get_max_lambda(ylist, X, numclust)
  
## Now, run the CV loop
la()
cvres = cv.flowmix(ylist=ylist, X=X, numclust=numclust,
                   max_mean_lambda=maxres$beta,
                   max_pie_lambda=maxres$alpha,
                   gridsize=10,
                   niter=500,
                   verbose=TRUE)
```
